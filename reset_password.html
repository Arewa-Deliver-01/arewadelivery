<!DOCTYPE html>
<html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Reset Password</title>
<link rel="stylesheet" href="assets/css/style.css"></head>
<body>
<header><nav class="navbar"><a class="logo" href="index.html">Arewadeliver</a><div class="menu-btn" onclick="toggleMenu()">☰</div></nav><div class="mobile-nav" id="mobileNav"><a href="index.html">Home</a></div></header>

<main>
  <div class="auth-container">
    <h2>Create a new password</h2>
    <div class="input-group"><label>New Password</label><input id="newPwd" type="password"></div>
    <div class="input-group"><label>Confirm Password</label><input id="confirmPwd" type="password"></div>
    <button class="auth-btn" id="resetBtn">Reset Password</button>
    <p id="resetMsg" style="color:#c00;margin-top:12px"></p>
  </div>
</main>

<footer class="site-footer"><div class="container"><p>© 2025 Arewadeliver</p></div></footer>
<script src="assets/js/main.js"></script>
<script src="assets/js/auth.js"></script>
<script>
  // Read token from URL (?token=...)
  const params = new URLSearchParams(window.location.search);
  const token = params.get('token');
  const out = document.getElementById('resetMsg');

  if(!token){ out.textContent = 'No reset token provided.'; document.getElementById('resetBtn').disabled = true; }

  document.getElementById('resetBtn').addEventListener('click', function(){
    const p1 = document.getElementById('newPwd').value;
    const p2 = document.getElementById('confirmPwd').value;
    out.textContent = '';
    if(!p1 || p1 !== p2){ out.textContent = 'Passwords must match.'; return; }
    const res = AV.resetPassword(token, p1);
    if(!res.ok){ out.textContent = res.message; return; }
    out.style.color = '#0a8a38';
    out.textContent = res.message + ' Redirecting to login...';
    setTimeout(()=> window.location = '/login.html', 1800);
  });
</script>
</body>
</html>
